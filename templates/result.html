<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hasil Prediksi</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Poppins", sans-serif; /* Terapkan Poppins */
        background-color: #f8f9fa;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }
      .main-content {
        flex-grow: 1;
      }
      .result-card {
        max-width: 700px;
        margin: 50px auto;
        text-align: center;
        padding: 30px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        border-radius: 10px;
      }
      .progress-bar-container {
        height: 30px;
        border-radius: 0.5rem;
        margin-top: 15px;
        margin-bottom: 20px;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
      <div class="container">
        <a class="navbar-brand" href="{{ url_for('check_diabetes_page') }}">
          Prediksi Diabetes
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('check_diabetes_page') }}"
                >Cek Diabetes</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('education') }}"
                >Pusat Edukasi</a
              >
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="container main-content">
      <div class="card result-card">
        <h1 class="card-title mb-4">üîî Hasil Prediksi Risiko Diabetes</h1>

        {% if result_error %}
        <div class="alert alert-danger" role="alert">
          <h4 class="alert-heading">‚ùå Proses Gagal</h4>
          <p>{{ result_error }}</p>
          <hr />
          <p class="mb-0">
            Silakan cek kembali input data Anda atau laporkan kesalahan ini.
          </p>
        </div>
        <a
          href="{{ url_for('check_diabetes_page') }}"
          class="btn btn-primary mt-3"
          >Kembali ke Form</a
        >
        {% else %} {% if prediction == 1 %}
        <div class="alert alert-danger" role="alert">
          <h4 class="alert-heading">‚ö†Ô∏è Risiko Tinggi Diabetes Ditemukan!</h4>
          <p class="mb-0">
            Berdasarkan data yang dimasukkan, hasil prediksi menunjukkan bahwa
            Anda memiliki <strong>risiko tinggi terkena diabetes</strong>.
          </p>
        </div>
        <p class="mt-3">
          Disarankan untuk <strong>segera berkonsultasi</strong> dengan tenaga
          medis profesional untuk pemeriksaan dan saran lebih lanjut.
        </p>
        {% else %}
        <div class="alert alert-success" role="alert">
          <h4 class="alert-heading">‚úÖ Risiko Diabetes Rendah Ditemukan.</h4>
          <p class="mb-0">
            Berdasarkan data yang dimasukkan, hasil prediksi menunjukkan bahwa
            Anda <strong>cenderung tidak menderita diabetes</strong>.
          </p>
        </div>
        <p class="mt-3">
          Tetap pertahankan <strong>gaya hidup sehat</strong> dan lakukan
          pemeriksaan rutin.
        </p>
        {% endif %}

        <hr />

        <h5 class="text-secondary mt-4">
          Tingkat Keyakinan Risiko: {{ risk_level }}
        </h5>

        <p>
          Probabilitas prediksi risiko diabetes:
          <strong>{{ probability }}</strong>
        </p>

        {% set bar_class = 'bg-danger' if probability_raw >= 70 else
        ('bg-warning' if probability_raw >= 50 else ('bg-info' if
        probability_raw >= 30 else 'bg-success')) %}

        <div
          class="progress progress-bar-container"
          role="progressbar"
          aria-label="Risk Probability"
          aria-valuenow="{{ probability_raw|int }}"
          aria-valuemin="0"
          aria-valuemax="100"
        >
          <div
            class="progress-bar {{ bar_class }}"
            style="width: {{ probability_raw }}%"
          ></div>
        </div>
        <hr />

        <h5 class="mt-4 mb-3 text-start text-primary">
          Data Input untuk Analisis (Faktor Kontributor):
        </h5>
        <div class="table-responsive">
          <table class="table table-bordered table-striped text-start">
            <thead class="table-light">
              <tr>
                <th>Parameter</th>
                <th>Nilai Anda</th>
                <th>Keterangan</th>
              </tr>
            </thead>
            <tbody>
              {% for key, value in input_data.items() %}
              <tr>
                <td class="fw-bold">{{ key }}</td>
                <td>{{ value }}</td>
                {% if key in ['Glucose', 'BMI', 'Insulin',
                'DiabetesPedigreeFunction'] %}
                <td class="text-danger">Parameter Medis Utama</td>
                {% elif key == 'Pregnancies' %}
                <td>Hanya untuk Wanita</td>
                {% else %}
                <td>Parameter Umum</td>
                {% endif %}
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        <p class="text-muted text-start small">
          Perhatikan nilai pada **Glukosa** dan **BMI** Anda, ini adalah faktor
          paling sensitif dalam model prediksi kami.
        </p>
        <hr />

        <a href="{{ url_for('check_diabetes_page') }}" class="btn btn-primary"
          >Lakukan Prediksi Baru</a
        >
        <a href="{{ url_for('education') }}" class="btn btn-outline-info ms-2"
          >Lihat Edukasi</a
        >

        {% endif %}
      </div>
    </div>

    <footer class="footer mt-auto py-3 bg-dark">
      <div class="container">
        <span class="text-white"
          >¬© 2025 Sistem Prediksi Diabetes | Dibuat dengan Bootstrap</span
        >
      </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
